<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ØªØ·Ø¨ÙŠÙ‚ SentenceEmbeddingOptimizer</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); min-height: 100vh; padding: 20px; line-height: 1.8; }
        .container { max-width: 1200px; margin: 0 auto; }
        .header { background: rgba(255, 255, 255, 0.95); padding: 30px; border-radius: 20px; box-shadow: 0 20px 40px rgba(0,0,0,0.1); margin-bottom: 30px; text-align: center; }
        .card { background: rgba(255, 255, 255, 0.95); border-radius: 20px; padding: 30px; margin-bottom: 30px; box-shadow: 0 20px 40px rgba(0,0,0,0.1); transition: transform 0.3s ease; }
        .card:hover { transform: translateY(-5px); }
        .card h2 { color: #2c3e50; font-size: 1.8em; margin-bottom: 20px; border-bottom: 3px solid #3498db; padding-bottom: 10px; }
        .code-box { background: linear-gradient(120deg, #2c3e50, #34495e); color: white; padding: 25px; border-radius: 15px; margin: 20px 0; direction: ltr; font-family: 'Courier New', monospace; overflow-x: auto; }
        .implementation-box { background: linear-gradient(120deg, #84fab0 0%, #8fd3f4 100%); padding: 20px; border-radius: 15px; margin: 20px 0; }
        .integration-box { background: linear-gradient(120deg, #ffecd2 0%, #fcb69f 100%); padding: 20px; border-radius: 15px; margin: 20px 0; }
        .pipeline-box { background: linear-gradient(120deg, #a8edea 0%, #fed6e3 100%); padding: 20px; border-radius: 15px; margin: 20px 0; }
        .warning-box { background: linear-gradient(120deg, #ff9a9e 0%, #fecfef 100%); padding: 20px; border-radius: 15px; margin: 20px 0; border-right: 5px solid #e74c3c; }
        .footer { background: rgba(44, 62, 80, 0.9); color: white; text-align: center; padding: 20px; border-radius: 15px; }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ğŸš€ ØªØ·Ø¨ÙŠÙ‚ SentenceEmbeddingOptimizer</h1>
            <p>Ø§Ù„Ø¯Ø±Ø³ Ø§Ù„Ø±Ø§Ø¨Ø¹ Ø¹Ø´Ø±: Ø§Ù„ÙƒÙˆØ¯ Ø§Ù„Ø¹Ù…Ù„ÙŠ ÙˆØ§Ù„ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„ÙØ¹Ù„ÙŠ</p>
        </div>

        <div class="card">
            <h2>ğŸ“¦ Ø§Ù„Ø§Ø³ØªÙŠØ±Ø§Ø¯ ÙˆØ§Ù„Ø¥Ø¹Ø¯Ø§Ø¯</h2>
            <div class="implementation-box">
                <h3>ğŸ”§ Ø£ÙˆÙ„Ø§Ù‹: Ø§Ø³ØªÙŠØ±Ø§Ø¯ Ø§Ù„Ù…ÙƒØªØ¨Ø§Øª Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©</h3>
                <div class="code-box">
from llama_index.core.postprocessor import SentenceEmbeddingOptimizer
from llama_index.embeddings.openai import OpenAIEmbedding
from llama_index.llms.openai import OpenAI
from llama_index.core import VectorStoreIndex, SimpleDirectoryReader
import os
                </div>
                
                <h3>ğŸ¯ Ø¥Ø¹Ø¯Ø§Ø¯ Ù…ØªØºÙŠØ±Ø§Øª Ø§Ù„Ø¨ÙŠØ¦Ø©:</h3>
                <div class="code-box">
# ØªØ£ÙƒØ¯ Ù…Ù† ÙˆØ¬ÙˆØ¯ OpenAI API key
os.environ["OPENAI_API_KEY"] = "your-api-key-here"
                </div>
            </div>
        </div>

        <div class="card">
            <h2>âš™ï¸ Ø¥Ù†Ø´Ø§Ø¡ SentenceEmbeddingOptimizer</h2>
            <div class="implementation-box">
                <h3>ğŸ® Ø§Ù„Ø·Ø±ÙŠÙ‚Ø© Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ©:</h3>
                <div class="code-box">
# Ø¥Ù†Ø´Ø§Ø¡ embedding model
embed_model = OpenAIEmbedding()

# Ø¥Ù†Ø´Ø§Ø¡ optimizer Ù…Ø¹ percentile cutoff
optimizer = SentenceEmbeddingOptimizer(
    embed_model=embed_model,
    percentile_cutoff=0.5  # Ø£ÙØ¶Ù„ 50% Ù…Ù† Ø§Ù„Ø¬Ù…Ù„
)
                </div>
                
                <h3>ğŸ”§ Ø·Ø±ÙŠÙ‚Ø© Ù…ØªÙ‚Ø¯Ù…Ø© Ù…Ø¹ Ù…Ø¹Ø§Ù…Ù„Ø§Øª Ø¥Ø¶Ø§ÙÙŠØ©:</h3>
                <div class="code-box">
# optimizer Ù…Ø¹ ÙƒÙ„ Ø§Ù„Ù…Ø¹Ø§Ù…Ù„Ø§Øª
advanced_optimizer = SentenceEmbeddingOptimizer(
    embed_model=embed_model,
    percentile_cutoff=0.6,      # Ø£ÙØ¶Ù„ 60% Ù…Ù† Ø§Ù„Ø¬Ù…Ù„
    threshold_cutoff=0.7,       # Ø¬Ù…Ù„ Ø¨Ù€ similarity > 0.7
    context_before=1,           # Ø¬Ù…Ù„Ø© ÙˆØ§Ø­Ø¯Ø© Ù‚Ø¨Ù„
    context_after=1             # Ø¬Ù…Ù„Ø© ÙˆØ§Ø­Ø¯Ø© Ø¨Ø¹Ø¯
)
                </div>
            </div>
        </div>

        <div class="card">
            <h2>ğŸ—ï¸ Ø¨Ù†Ø§Ø¡ Ø§Ù„ÙÙ‡Ø±Ø³ Ù…Ø¹ Optimizer</h2>
            <div class="integration-box">
                <h3>ğŸ“š ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª:</h3>
                <div class="code-box">
# ØªØ­Ù…ÙŠÙ„ Ø§Ù„ÙˆØ«Ø§Ø¦Ù‚
documents = SimpleDirectoryReader("./data").load_data()

# Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„ÙÙ‡Ø±Ø³
index = VectorStoreIndex.from_documents(documents)
                </div>
                
                <h3>ğŸ” Ø¥Ù†Ø´Ø§Ø¡ Query Engine Ù…Ø¹ Optimizer:</h3>
                <div class="code-box">
# Ø¥Ù†Ø´Ø§Ø¡ query engine Ù…Ø¹ postprocessor
query_engine = index.as_query_engine(
    node_postprocessors=[optimizer],
    similarity_top_k=10  # Ø£Ø­Ø¶Ø± 10 nodes Ø£ÙˆÙ„Ø§Ù‹
)
                </div>
                
                <h3>ğŸ’¡ ÙÙ‡Ù… Ø§Ù„ØªØ³Ù„Ø³Ù„:</h3>
                <ol>
                    <li><strong>Ø§Ù„Ø¨Ø­Ø« Ø§Ù„Ø£ÙˆÙ„ÙŠ:</strong> similarity_top_k=10 nodes</li>
                    <li><strong>ØªØ·Ø¨ÙŠÙ‚ Optimizer:</strong> ØªØ­Ø³ÙŠÙ† Ø§Ù„Ù€ nodes</li>
                    <li><strong>Ø§Ù„Ù†ØªÙŠØ¬Ø© Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠØ©:</strong> Ø£ÙØ¶Ù„ Ù…Ø­ØªÙˆÙ‰ Ù…Ø­Ø³Ù†</li>
                </ol>
            </div>
        </div>

        <div class="card">
            <h2>ğŸ”„ Pipeline ÙƒØ§Ù…Ù„ Ù…Ø¹ Ù…Ø¹Ø§Ù„Ø¬Ø© Ù…ØªØ¹Ø¯Ø¯Ø©</h2>
            <div class="pipeline-box">
                <h3>ğŸ› ï¸ Ø¥Ù†Ø´Ø§Ø¡ pipeline Ù…ØªØ¹Ø¯Ø¯ Ø§Ù„Ø·Ø¨Ù‚Ø§Øª:</h3>
                <div class="code-box">
from llama_index.core.postprocessor import (
    SimilarityPostprocessor,
    KeywordNodePostprocessor
)

# Ø¥Ù†Ø´Ø§Ø¡ Ø¹Ø¯Ø© postprocessors
similarity_filter = SimilarityPostprocessor(similarity_cutoff=0.6)
keyword_filter = KeywordNodePostprocessor(
    keywords=["RAG", "vector", "embedding"],
    exclude_keywords=["irrelevant", "spam"]
)
sentence_optimizer = SentenceEmbeddingOptimizer(
    embed_model=embed_model,
    percentile_cutoff=0.7
)

# ØªØ±ØªÙŠØ¨ Ø§Ù„Ù…Ø¹Ø§Ù„Ø¬Ø©
postprocessors = [
    similarity_filter,      # Ø£ÙˆÙ„Ø§Ù‹: ÙÙ„ØªØ±Ø© Ø¨Ø§Ù„ØªØ´Ø§Ø¨Ù‡
    keyword_filter,         # Ø«Ø§Ù†ÙŠØ§Ù‹: ÙÙ„ØªØ±Ø© Ø¨Ø§Ù„ÙƒÙ„Ù…Ø§Øª Ø§Ù„Ù…ÙØªØ§Ø­ÙŠØ©  
    sentence_optimizer      # Ø£Ø®ÙŠØ±Ø§Ù‹: ØªØ­Ø³ÙŠÙ† Ø§Ù„Ø¬Ù…Ù„
]

# Ø¥Ù†Ø´Ø§Ø¡ query engine Ù…Ø¹ Pipeline
optimized_query_engine = index.as_query_engine(
    node_postprocessors=postprocessors,
    similarity_top_k=15
)
                </div>
            </div>
        </div>

        <div class="card">
            <h2>ğŸ¯ Ø£Ù…Ø«Ù„Ø© Ø¹Ù…Ù„ÙŠØ© Ù„Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù…</h2>
            <div class="implementation-box">
                <h3>ğŸ’¬ Ø§Ø³ØªØ¹Ù„Ø§Ù… Ø¨Ø³ÙŠØ·:</h3>
                <div class="code-box">
# Ø³Ø¤Ø§Ù„ Ø¨Ø³ÙŠØ·
query = "What is RAG and how does it work?"
response = query_engine.query(query)
print(response)
                </div>
                
                <h3>ğŸ” Ø§Ø³ØªØ¹Ù„Ø§Ù… Ù…ØªÙ‚Ø¯Ù…:</h3>
                <div class="code-box">
# Ø³Ø¤Ø§Ù„ Ù…Ø¹Ù‚Ø¯ Ù…Ø¹ Ø§Ù„Ù€ optimized engine
complex_query = "Explain the components of a RAG system and their interactions"
optimized_response = optimized_query_engine.query(complex_query)
print(f"Optimized Response: {optimized_response}")
                </div>
                
                <h3>ğŸ“Š Ù…Ù‚Ø§Ø±Ù†Ø© Ø§Ù„Ù†ØªØ§Ø¦Ø¬:</h3>
                <div class="code-box">
# Ù…Ù‚Ø§Ø±Ù†Ø© Ù…Ø¹ ÙˆØ¨Ø¯ÙˆÙ† optimizer
query = "How to improve RAG performance?"

# Ø¨Ø¯ÙˆÙ† optimizer
normal_engine = index.as_query_engine(similarity_top_k=5)
normal_response = normal_engine.query(query)

# Ù…Ø¹ optimizer
optimized_response = query_engine.query(query)

print("Normal Response Length:", len(str(normal_response)))
print("Optimized Response Length:", len(str(optimized_response)))
                </div>
            </div>
        </div>

        <div class="card">
            <h2>âš™ï¸ Ø¶Ø¨Ø· Ø¯Ù‚ÙŠÙ‚ Ù„Ù„Ù…Ø¹Ø§Ù…Ù„Ø§Øª</h2>
            <div class="integration-box">
                <h3>ğŸ® ØªØ¬Ø±Ø¨Ø© Ù‚ÙŠÙ… Ù…Ø®ØªÙ„ÙØ©:</h3>
                <div class="code-box">
# ØªØ¬Ø±Ø¨Ø© Ù‚ÙŠÙ… Ù…Ø®ØªÙ„ÙØ© Ù„Ù„Ù€ percentile
percentiles = [0.3, 0.5, 0.7, 0.9]

for p in percentiles:
    test_optimizer = SentenceEmbeddingOptimizer(
        embed_model=embed_model,
        percentile_cutoff=p
    )
    
    test_engine = index.as_query_engine(
        node_postprocessors=[test_optimizer],
        similarity_top_k=10
    )
    
    response = test_engine.query("Explain vector embeddings")
    print(f"Percentile {p}: Response length = {len(str(response))}")
                </div>
                
                <h3>ğŸ“ˆ Ù‚ÙŠØ§Ø³ Ø§Ù„Ø£Ø¯Ø§Ø¡:</h3>
                <div class="code-box">
import time

def measure_performance(engine, query):
    start_time = time.time()
    response = engine.query(query)
    end_time = time.time()
    
    return {
        'response_length': len(str(response)),
        'processing_time': end_time - start_time,
        'response': str(response)
    }

# Ù‚ÙŠØ§Ø³ Ø§Ù„Ø£Ø¯Ø§Ø¡
test_query = "What are the benefits of using RAG?"
performance = measure_performance(optimized_query_engine, test_query)
print(f"Processing time: {performance['processing_time']:.2f} seconds")
print(f"Response length: {performance['response_length']} characters")
                </div>
            </div>
        </div>

        <div class="card">
            <h2>âš ï¸ Ù…Ù„Ø§Ø­Ø¸Ø§Øª Ù…Ù‡Ù…Ø© Ù„Ù„ØªØ·Ø¨ÙŠÙ‚</h2>
            <div class="warning-box">
                <h3>ğŸ¯ Ø£ÙØ¶Ù„ Ø§Ù„Ù…Ù…Ø§Ø±Ø³Ø§Øª:</h3>
                <ul>
                    <li><strong>Ø§Ø¨Ø¯Ø£ Ø¨Ù‚ÙŠÙ… Ù…ØªØ­ÙØ¸Ø©:</strong> percentile_cutoff=0.5</li>
                    <li><strong>Ø§Ø®ØªØ¨Ø± Ø¹Ù„Ù‰ Ø¨ÙŠØ§Ù†Ø§ØªÙƒ:</strong> ÙƒÙ„ dataset Ù…Ø®ØªÙ„Ù</li>
                    <li><strong>Ø±Ø§Ù‚Ø¨ ÙˆÙ‚Øª Ø§Ù„ØªÙ†ÙÙŠØ°:</strong> Optimizer ÙŠØ¶ÙŠÙ overhead</li>
                    <li><strong>ÙˆØ§Ø²Ù† Ø¨ÙŠÙ† Ø§Ù„Ø¬ÙˆØ¯Ø© ÙˆØ§Ù„Ø³Ø±Ø¹Ø©:</strong> Ø­Ø³Ø¨ Ø§Ø­ØªÙŠØ§Ø¬Ø§ØªÙƒ</li>
                </ul>
                
                <h3>ğŸš« Ø£Ø®Ø·Ø§Ø¡ Ø´Ø§Ø¦Ø¹Ø©:</h3>
                <ul>
                    <li><strong>percentile_cutoff Ø¹Ø§Ù„ÙŠ Ø¬Ø¯Ø§Ù‹:</strong> Ù‚Ø¯ ÙŠÙÙ‚Ø¯ Ù…Ø­ØªÙˆÙ‰ Ù…Ù‡Ù…</li>
                    <li><strong>threshold_cutoff Ù…Ù†Ø®ÙØ¶ Ø¬Ø¯Ø§Ù‹:</strong> Ù‚Ø¯ ÙŠØ³Ù…Ø­ Ø¨Ù…Ø­ØªÙˆÙ‰ Ø¶Ø¹ÙŠÙ</li>
                    <li><strong>context Ù…ÙØ±Ø·:</strong> Ù‚Ø¯ ÙŠØ¶ÙŠÙ noise</li>
                </ul>
            </div>
        </div>

        <div class="footer">
            <p>ğŸ¯ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„Ø³Ù„ÙŠÙ… = Ù†ØªØ§Ø¦Ø¬ Ù…Ø­Ø³Ù†Ø© ÙˆØ£Ø¯Ø§Ø¡ Ø£ÙØ¶Ù„!</p>
        </div>
    </div>
</body>
</html>