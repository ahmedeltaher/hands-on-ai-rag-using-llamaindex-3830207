# ๐ [RetryGuidelineQueryEngine](https://github.com/run-llama/llama_index/blob/b767f274f8563298b607229e4598b4ed92056394/llama-index-core/llama_index/core/query_engine/retry_query_engine.py#L71)

ุงูู **RetryGuidelineQueryEngine** ูุนููู ุนุดุงู ูุญุณูู ุฌูุฏุฉ ุงูุฑุฏูุฏ ุจุดูู ูุชูุฑุฑุ  
ุนู ุทุฑูู ุฅูู ููุงุฑู ุงูุฑุฏ ุจุงูู **guidelines** (ุงูููุงุนุฏ ุฃู ุงููุนุงููุฑ ุงููุญุฏุฏุฉ ูุณุจููุง)ุ  
ููู ุงูุฑุฏ ูุง ุงูุชุฒูุด ุจููุงุ ุจูุญููู ุงูุณุคุงู ุจูุงุกู ุนูู ูุชูุฌุฉ ุงูุชููููุ  
ููุนูุฏ ุงููุญุงููุฉ ุจุงูุณุคุงู ุงููุนุฏูู โ ูุญุฏ ูุง ูุทูุน ุจุฑุฏ ูุฑุถู ุฃู ููุตู ููุญุฏ ุงูุฃูุตู ูู ุนุฏุฏ ุงููุญุงููุงุช ๐  

---

## โ๏ธ ุงูุจุฑุงููุชุฑุงุช ุงููู ูุญุชุงุฌ ุชุนุฑููุง

- **`query_engine`** โ  
  ุฏู ุงููุญุฑู ุงูุฃุณุงุณู ุงููู ุจููููุฐ ุงูุงุณุชุนูุงูุงุช.

- **`guideline_evaluator`** โ  
  ูู ุงููู ุจููููู ุฌูุฏุฉ ุงูุฑุฏูุฏ ุจูุงุกู ุนูู ูุฌููุนุฉ ููุงุนุฏ (guidelines) ูุญุฏุฏุฉ ูุณุจููุง.

- **`resynthesize_query`** โ  
  ููุงุบ (boolean) ุจูุญุฏุฏ ุฅุฐุง ูุงู ููุนูุฏ ุตูุงุบุฉ ุงูุณุคุงู ุจูุงุกู ุนูู ูุชูุฌุฉ ุงูุชูููู ููุง ูุฃ.

- **`max_retries`** โ  
  ุฃูุตู ุนุฏุฏ ูุญุงููุงุช ููููุฉ ูุฅุนุงุฏุฉ ุงูุชุฌุฑุจุฉ.

- **`query_transformer`** โ  
  ุงูุฌุฒุก ุงููู ุจูุญููู ุงูุณุคุงู ุจูุงุกู ุนูู ูุชูุฌุฉ ุงูุชูููู (ุงูุชุฑุงุถููุง: `FeedbackQueryTransformation`).

---

## ๐ ุงููู ุจูุญุตู ุฌูู ุงูููุฏ (Under the hood)

1. ุฃูู ูุง ูุชู ุงุณุชุฏุนุงุก ุงูุฏุงูุฉ `query` ููุนุงูุง ูุงุฆู `QueryBundle`ุ  
   ุงููุญุฑู ุจูุจุฏุฃ ูุณุฃู ุงูู `query_engine` ุงูุฃุณุงุณู ุนุดุงู ูุฌูุจ **ุงูุฑุฏ ุงูุฃููู**.  

2. ูู ูููุฉ `max_retries` ูุงูุช 0 ุฃู ุฃูู โ ุจูุฑุฌุน ุงูุฑุฏ ุฒู ูุง ูู ูู ุบูุฑ ุชูููู ููุง ูุญุงููุงุช ุฅุถุงููุฉ.  

3. ูู `max_retries` ุฃูุจุฑ ูู 0 โ  
   ุจูุณุชุฎุฏู ุงูุฏุงูุฉ `evaluate_response` ุงููู ุฌูู ุงูู `guideline_evaluator` ุนุดุงู ูููู ุงูุฑุฏ.  

4. ูู ุงูุฑุฏ **ูุฌุญ ูู ุงูุชูููู** โ ุจูุชุฑุงุฌุน ุฒู ูุง ูู โ  

5. ูู ุงูุฑุฏ **ูุดู ูู ุงูุชูููู** โ ุจูุจุฏุฃ ููุง ุงูุดุบู ุงูุชููู ๐:
   - ุจูุนูู instance ุฌุฏูุฏุฉ ูู `RetryGuidelineQueryEngine`  
     ุจููุณ ุงูุฅุนุฏุงุฏุงุช (query_engine, guideline_evaluator, resynthesize_query)ุ  
     ุจุณ ูููู `max_retries` ุจููุฏุงุฑ 1.  
   - ุจุนุฏูู ุจูุณุชุฎุฏู `query_transformer` (ุงููู ูู ุงูุชุฑุงุถููุง `FeedbackQueryTransformation`)  
     ุนุดุงู **ูุญููู ุงูุณุคุงู ุงูุฃุตูู** ุจูุงุกู ุนูู ูุชูุฌุฉ ุงูุชูููู.  
   - ุจูุงุฎุฏ ุงูุณุคุงู ุงููุนุฏูู ุฏู ููุจุนุชู ููู `query` ุจุชุงุนุฉ ุงููุณุฎุฉ ุงูุฌุฏูุฏุฉ ูู ุงููุญุฑู.  

6. ุจููุฑุฑ ุงูุฎุทูุงุช ุฏู ูู ุฃูู ุชุงูู (ุงูุฎุทูุฉ 2)  
   ูุญุฏ ูุง ูุทูุน ุจุฑุฏ ูุฑุถู ุฃู ููุตู ููุญุฏ ุงูุฃูุตู ูู ุนุฏุฏ ุงููุญุงููุงุช (`max_retries`).  

---

## โ ุงูุฎูุงุตุฉ

ุงูู **RetryGuidelineQueryEngine** ุฒู ุงูููุฏูู ุงููู ุนูุฏู ูุฏุฑุจ ุฎุงุต ๐ช  
ูู ูุฑุฉ ูุบูุทุ ุงูููููู ููููู โุบูุทู ูููโ ููุฏููู feedbackุ  
ููุฑุฌุน ูุนุฏูู ุณุคุงูู ููุฌุฑุจ ุชุงูู ูุญุฏ ูุง ูุฌูุจ ุงูุฅุฌุงุจุฉ ุงูุตุญ.  

ุงููุธุงู ุฏู ุจูุฎูู ุงูููุฏูู ุฃูุซุฑ ุฏูุฉุ ูุฃูู ูููุณุฉุ  
ูุจูุชุนุงูู ูุน ุงููุนุงููุฑ (guidelines) ูุฃููุง ููุงุนุฏ ุตุงุฑูุฉ ูุงุฒู ููุชุฒู ุจููุง ๐ฅ  
---
# ๐ค ูุญุฑูุงุช ุงูุงุณุชุนูุงู ุฐุงุชูุฉ ุงูุชุตุญูุญ (Self-Correcting Query Engines)

ูุญุฑูุงุช ุงูุงุณุชุนูุงู ุฐุงุชูุฉ ุงูุชุตุญูุญ ูู **LlamaIndex** ุจุชุฑุงุฌุน ุงูุฅุฌุงุจุงุช ุงููู ุจุชุทูุนูุง ุจููุณูุงุ  
ููู ููุช ุฅู ุงูุฑุฏ ูุด ุฏููู ุฃู ูุด ููุงูุฉุ ุจุชุนูุฏ ุงููุญุงููุฉ ุนุดุงู ุชุทูุน ุฑุฏ ุฃุญุณู ๐  
ุงููุฏู ูููุง ุฅููุง **ุชุญุณูู ุฌูุฏุฉ ุงููุชุงุฆุฌ** ุงููู ุจุชุทูุน ูู ูุญุฑู ุงูุงุณุชุนูุงู ุงูุฃุณุงุณู.

---

## ๐งฉ ุฃููุงุน ูุญุฑูุงุช ุงูู Self-Correcting

### ๐ **Retry Query Engine**
ุงููุญุฑู ุฏู ุจูุณุชุฎุฏู "ููููู" (Evaluator) ุนุดุงู ูุญุณูู ุงูุฑุฏูุฏ.  
ุจูุจุฏุฃ ูุณุฃู ุงููุญุฑู ุงูุฃุณุงุณู ุงูุฃููุ ูุจุนุฏ ูุฏู ุงูููููู ุจูุดูู ุฅุฐุง ุงูุฑุฏ ุชูุงู ููุง ูุฃ.  
- ูู ุงูุฑุฏ **ูููุณ** โ ุจูุฑุฌูุนู ุนูู ุทูู.  
- ูู ุงูุฑุฏ **ูุด ุชูุงู** โ ุจูุญููู ุงูุณุคุงู ุงูุฃุตูู ูุณุคุงู ุฌุฏูุฏ ุจูุงุกู ุนูู ุงููุชูุฌุฉุ  
  ููุนูุฏ ุงููุญุงููุฉ ูุฐุง ูุฑุฉ (ูุญุฏ ุนุฏุฏ ูุนูู ูู ุงูู retries).

---

### ๐ง **Retry Source Query Engine**
ุงูููุน ุฏู ุจูุดุชุบู ุนูู **ูุตุงุฏุฑ ุงูุจูุงูุงุช ููุณูุง**ุ  
ูุจูููุชุฑ ุงูู source nodes ุงููู ุจูุณุชุฎุฏููุง ุงูุงุณุชุนูุงู ุจูุงุกู ุนูู ุชูููู ุงูููุฏูู.  
ูุนูู ุจุจุณุงุทุฉุ ุจูุฎุชุงุฑ ุจุณ ุงููุตุงุฏุฑ ุงููู ุดูููุง ูููุฏ ูุนูุงู ููุณุคุงู.

---

### ๐ **Retry Guideline Query Engine**
ุงููุญุฑู ุฏู ุจูุณุชุฎุฏู **ููุงุนุฏ (Guidelines)** ุนุดุงู ููุฌูู ุงูููููู ุฅุฒุงู ูุชุตุฑู.  
ูููู ููุงู ุชุถูู ุงูููุงุนุฏ ุงูุฎุงุตุฉ ุจูู.  
ุงูููุฏูู ุจููุงุฑู ุงูุฅุฌุงุจุฉ ุจุงูููุงุนุฏ ุฏูุ ููู ูุง ุงูุชุฒูุชุด ุจููุงุ ุจูุญููู ุงูุณุคุงู ููุนูุฏ ุงููุญุงููุฉ.

---

# ๐ [RetryQueryEngine](https://github.com/run-llama/llama_index/blob/main/llama-index-core/llama_index/core/query_engine/retry_query_engine.py)

ุงูู `RetryQueryEngine` ูุนููู ูุฎุตูุต ุนุดุงู ูุญุณูู ุฌูุฏุฉ ุงูุฑุฏูุฏ.  
ูู ุฃูู ุงุณุชุฌุงุจุฉ ูุด ุฏูููุฉ ููุงูุฉุ ุจูุนูุฏ ุชูููุฐ ุงูุงุณุชุนูุงู ุชุงูู ุจุนุฏ ูุง ูุฑุงุฌุน ุงููุชูุฌุฉ.  

ุงูููุฑุฉ ุฅู ุฃุญูุงููุง ุฃูู ุฅุฌุงุจุฉ ุจุชููู ูุงูุตุฉ ุฃู ูููุง ุบูุท ุจุณูุทุ  
ูุงูู RetryQueryEngine ุจูุดุบูู ุนูููุฉ ุชูููู ูุฑุฏ ูุนู ุชููุงุฆูุฉ โ  
ูููู ุงูุฑุฏุ ูุนุฏูู ุงูุณุคุงู ูู ูุญุชุงุฌุ ููุนูุฏ ุงููุญุงููุฉ ูุญุฏ ูุง ูุทูุน ุจุฑุฏ ูุฑุถู ๐  

---

## โ๏ธ ุงูุจุฑุงููุชุฑุงุช ุงููู ูุงุฒู ุชุนุฑููุง

1. **`query_engine`** โ  
   ุฏู ุงููุญุฑู ุงูุฃุณุงุณู ุงููู ุจููููุฐ ุงูุงุณุชุนูุงูุงุช ูุนูููุง.  
   ูุงุฒู ูููู ูุนููู ูู ุชููุฆุฉ ูุจู ูุฏู ูุฌุงูุฒ ููุชุนุงูู ูุน ููุน ุงูุฃุณุฆูุฉ ุงููู ุจุชุณุฃููุง.

2. **`evaluator`** โ  
   ูู ุงููุณุคูู ุนู ุชูููู ุฌูุฏุฉ ุงูุฑุฏูุฏ.  
   ูุงุฒู ูููู ุนูุฏู ุฏุงูุฉ ุงุณููุง `evaluate_response`  
   ุจุชุงุฎุฏ ุงูุณุคุงู ูุงูุฑุฏ ููุฏุฎูุ ูุชุฑุฌุน ูุชูุฌุฉ ุจุชููู ุฅุฐุง ุงูุฑุฏ ูููุณ ููุง ูุญุชุงุฌ ุชุนุฏูู.

3. **`max_retries`** โ  
   ุนุฏุฏ ุงููุญุงููุงุช ุงููุตูู ูุฅุนุงุฏุฉ ุงูุงุณุชุนูุงู.  
   ูุนูู ูู ุงูุฑุฏ ูุด ูุฑุถูุ ููุฑุฌุน ูุญุงูู ุชุงูู ูุญุฏ ุงูุนุฏุฏ ุฏู (ุงูุชุฑุงุถููุง = 3).

4. **`callback_manager`** โ  
   ุจูููุฏู ุฃู ุนูููุงุช ุฅุถุงููุฉ ุฃู callbacks ุจุชุญุตู ุฃุซูุงุก ุชูููุฐ ุงูุงุณุชุนูุงูุ  
   ุฒู ุงูุชุณุฌููุ ุงูุชุญูููุ ุฃู ุฃู event ุนุงูุฒ ุชูุตูู ุฃุซูุงุก ุงูุชุดุบูู.

---

## ๐ ุงููู ุจูุญุตู ุฌูู ุงูููุฏ (Under the hood)

ุงูู RetryQueryEngine ุจูุดุชุบู ุจุดูู ูุชูุฑุฑ (Iterative):  
ูุณุฃูุ ูุฑุงุฌุนุ ูุนูุฏ ุงูุตูุงุบุฉุ ููุฌุฑุจ ุชุงูู โ ูุญุฏ ูุง ููุตู ููุชูุฌุฉ ูุฑุถูุฉ ุฃู ูุฎูุต ุนุฏุฏ ุงููุญุงููุงุช.

### ๐ช ุงูุฎุทูุงุช:

1. ุงููุญุฑู ุจูุจุฏุฃ ูุณุฃู ุงูู `query_engine` ุงูุฃุณุงุณู ุจุงุณุชุฎุฏุงู ุงูู `QueryBundle` ุงูุฃุตูู.  
2. ุจุนุฏ ูุฏู ุจูุณุชุฎุฏู ุงูู `evaluator` ุนุดุงู ูุดูู ุฅุฐุง ุงูุฑุฏ ุนุฏู ุงูุชูููู ููุง ูุฃ.  
3. ูู ุงูุฑุฏ **ุนุฏูู ุงูุชูููู** (`eval.passing = True`) โ ุจูุฑุฌุน ุงูุฑุฏ ููุฑูุง.  
4. ูู ุงูุฑุฏ **ูุง ุนุฏูุงุด** (`eval.passing = False`) โ  
   ุจูุญููู ุงูุณุคุงู ุงูุฃุตูู ูุณุคุงู ุฌุฏูุฏ ุจุงุณุชุฎุฏุงู ููุงุณ ุงุณูู `FeedbackQueryTransformation`.  
   ุงูุชุญููู ุฏู ุจูุจูู ุนูู ุงูุณุคุงู ุงููุฏููุ ุงูุฑุฏ ุงููู ุทูุนุ ูุงูุชูููู ุงููู ุญุตู.  
5. ุจุนุฏูู ุจููููู instance ุฌุฏูุฏุฉ ูู ููุณู (`RetryQueryEngine`)  
   ุจููุณ ุงูุฅุนุฏุงุฏุงุช (query_engine, evaluator) ููู ุจุนุฏุฏ ูุญุงููุงุช ุฃูู.  
6. ุจูุดุบูู ุงูุงุณุชุนูุงู ุงูุฌุฏูุฏุ ููุฑุฌุน ูุจุฏุฃ ูู ุฃูู ุฎุทูุฉ ุชุงูู.  
7. ุงูุนูููุฉ ุฏู ุจุชุณุชูุฑ ูุญุฏ ูุง ูุทูุน ุฑุฏ ูุฑุถู ุฃู ููุตู ููุญุฏ ุงูุฃูุตู ูู ุงูู retries.  
8. ูู ุงูุขุฎุฑ ุจูุฑุฌุน ุงูุฑุฏ ุงูููุงุฆู โ ุณูุงุก ูุงู ูุงุฌุญ ุฃู ูุตู ููุญุฏ ุงูุฃูุตู ูููุญุงููุงุช.

---

## โ ุงูุฎูุงุตุฉ

ูุญุฑูุงุช ุงูู **Self-Correcting** ุฏู ุฒู ุงููุฏุฑูุจ ุงูุฐูู ููู AI โจ  
ูู ูุฑุฉ ุงูููุฏูู ูุบูุทุ ุจูุตููุญ ููุณู ููุชุนููุ ูุญุฏ ูุง ููุตู ูุฃูุถู ุฑุฏ ูููู.  

ุจูุฏู ุชุถูู ุฌูุฏุฉ ุฃุนููุ ุงุณุชุฌุงุจุงุช ุฃุฏูุ ูุชุฌุฑุจุฉ Query Engine ุฃูุฑุจ ูุทุฑููุฉ ุงูุชูููุฑ ุงูุจุดุฑู ๐ช  
---
# ๐ [RetrySourceQueryEngine](https://github.com/run-llama/llama_index/blob/b767f274f8563298b607229e4598b4ed92056394/llama-index-core/llama_index/core/query_engine/retry_source_query_engine.py#L25)

ุงูู **RetrySourceQueryEngine** ูู ููุน ูู ูุญุฑูุงุช ุงูุงุณุชุนูุงู ุงููู ุจูุนูุฏ ุงููุญุงููุฉ ููู ุจุทุฑููุฉ ูุฎุชููุฉ ุดููุฉ ๐  
ุจุฏู ูุง ูุนูุฏ ุงูุงุณุชุนูุงู ููู ุฒู ูุง ููุ ุจูุญุงูู ูุณุชุฎุฏู **ูุฌููุนุฉ ูุฑุนูุฉ ูู ุงูู source nodes** (ูุนูู ุงููุตุงุฏุฑ ุงููู ุทูุน ูููุง ุงูุฑุฏ ุงูุฃูู)  
ูู ููู ุฅู ุงูุฑุฏ ุงูุฃูู ูุด ุฏููู ุฃู ูุดู ูู ุงูุชูููู.  

ุงููุฏู ููู ุฅูู **ูุญุณูู ุฌูุฏุฉ ุงูุฅุฌุงุจุงุช** ุนู ุทุฑูู ุฅูู ูุฎุชุงุฑ ุจุณ ุงููุตุงุฏุฑ ุงููู ุฃุซุจุชุช ุฅููุง ูููุฏุฉุ  
ููุนูู index ุฌุฏูุฏ ุจุงููุตุงุฏุฑ ุฏูุ ูุจุนุฏ ูุฏู ูุนูุฏ ุชูููุฐ ุงูุงุณุชุนูุงู ุนูู ุงูู index ุงููุตููู ุฏู.

---

## โ๏ธ ุงูุจุฑุงููุชุฑุงุช ุงููู ูุงุฒู ุชุนุฑููุง

- **`query_engine`** โ  
  ุงููุญุฑู ุงูุฃุณุงุณู ุงููู ุจูุดุบูู ุงูุงุณุชุนูุงู ูู ุงูุจุฏุงูุฉ.

- **`evaluator`** โ  
  ุงููู ุจููููู ุฌูุฏุฉ ุงูุฑุฏูุฏ ูููุงู ุฌูุฏุฉ ุงูู source nodes ููุณูุง.

- **`max_retries`** โ  
  ุฃูุตู ุนุฏุฏ ูุฑุงุช ุฅุนุงุฏุฉ ุงููุญุงููุฉ ุงููุณููุญ ุจููุง.

---

## ๐ ุงููู ุจูุญุตู ุฌูู ุงูููุฏ (Under the hood)

1. ุงููุญุฑู ุจูุณุชุฎุฏู ุงูู `query_engine` ุงูุฃุณุงุณู ุนุดุงู ูุฌูุจ **ุงูุฑุฏ ุงูุฃููู**.  
2. ุจุนุฏ ูุฏู ุจูุณุชุฎุฏู ุงูู `evaluator` ุนุดุงู ูุดูู ูู ุงูุฑุฏ ุฏู ุนุฏู ุงูุชูููู ููุง ูุฃ.  
3. ูู ุงูุฑุฏ **ุนุฏูู ุงูุชูููู** โ ุจูุฑุฌูุน ุงููุชูุฌุฉ ุนูู ุทูู โ  
4. ูู ุงูุฑุฏ **ูุง ุนุฏูุงุด ุงูุชูููู** โ ุจูุจุฏุฃ ุณูุณูุฉ ุฎุทูุงุช ุฐููุฉ:
   - ุจููููู ูู **source node** ููุญุฏูุง ููุดูู ุฃููู ูุงุญุฏุฉ ูููู ูููุฏุฉ.  
   - ุจูุจูู **index ุฌุฏูุฏ** ุจุงููุตุงุฏุฑ ุงููู ูุฌุญุช ูู ุงูุชูููู ุจุณ.  
   - ุจููููู **RetrieverQueryEngine ุฌุฏูุฏ** ุนูู ุงูู index ุงูุฌุฏูุฏ ุฏู.  
   - ุจูุนูู **RetrySourceQueryEngine ุฌุฏูุฏ** ุจููุณ ุงูุฅุนุฏุงุฏุงุช ููู ุจุนุฏุฏ ูุญุงููุงุช ุฃูู.  
   - ููุนูุฏ ุชุดุบูู ุงูุงุณุชุนูุงู ูู ุงูุฃูู ุจุงูู query ุงูุฌุฏูุฏ ุฏู ๐  
5. ุจููุฑุฑ ุงูุฎุทูุงุช ุฏู ูุญุฏ ูุง ูุทูุน ุฑุฏ ูููุณ ุฃู ููุตู ูุฃูุตู ุนุฏุฏ ูุญุงููุงุช (`max_retries`).

---

## โ ุงูุฎูุงุตุฉ

ุงูู **RetrySourceQueryEngine** ูู ุฒู ุงูุฐูุงุก ุงููู ุจูุชุนูู ูู ุฃุฎุทุงุคู ๐ก  
ูู ูุฑุฉ ุจูุบูุท ูููุงุ ุจูุดูู ุงููุตุงุฏุฑ ุงููู ูุงูุช ุงูุณุจุจุ ูููููู ุจุงููู ูุนูุงู ุจูููุฏ.  
ูุฏู ุจูุฎููู ููุชุงุฒ ููุง ุชููู ุงูุจูุงูุงุช ูููุง ุถูุถุงุก ุฃู ูุตุงุฏุฑ ูุชูุฑ ูุด ุฏูููุฉ.  
---
# ๐ [RetrySourceQueryEngine](https://github.com/run-llama/llama_index/blob/b767f274f8563298b607229e4598b4ed92056394/llama-index-core/llama_index/core/query_engine/retry_source_query_engine.py#L25)

ุงูู **RetrySourceQueryEngine** ูู ููุน ูู ูุญุฑูุงุช ุงูุงุณุชุนูุงู ุงููู ุจูุนูุฏ ุชุดุบูู ุงูุงุณุชุนูุงู ุชุงููุ  
ุจุณ ุงููุฑุฉ ุฏู ุจุงุณุชุฎุฏุงู **ูุฌููุนุฉ ูุญุฏุฏุฉ ูู ุงููุตุงุฏุฑ (source nodes)** ูู ุงูุฑุฏ ุงูุฃูู ูุง ุนุฏุงุด ุงูุชูููู. ๐  

ุงูููุฑุฉ ููุง ุฅูู ุจูุฑููุฒ ุนูู **ุชุญุณูู ุฌูุฏุฉ ุงูุฅุฌุงุจุฉ** ุนู ุทุฑูู ุฅูู ูุฎุชุงุฑ ุจุณ ุงููุตุงุฏุฑ ุงููู ูุฌุญุช ูู ุงูุชููููุ  
ููุนูู ูููู **index ุฌุฏูุฏ**ุ ูุจุนุฏูู ูุนูุฏ ุชูููุฐ ุงูุงุณุชุนูุงู ุนูู ุงูู index ุงูููููู ุฏู ุนุดุงู ูุฌูุจ ูุชูุฌุฉ ุฃุฏู.  

---

## โ๏ธ ุงูุจุฑุงููุชุฑุงุช ุงููู ูุงุฒู ุชุนุฑููุง

- **`query_engine`** โ  
  ุงููุญุฑู ุงูุฃุณุงุณู ุงููู ุจูุดุบูู ุงูุงุณุชุนูุงู.

- **`evaluator`** โ  
  ุงูููููู ุงููู ุจููููู ุฌูุฏุฉ ุงูุฑุฏูุฏ ูุฌูุฏุฉ ุงูู source nodes.

- **`max_retries`** โ  
  ุฃูุตู ุนุฏุฏ ูุฑุงุช ุฅุนุงุฏุฉ ุงููุญุงููุฉ ุงููู ูุณููุญ ุจููุง.

---

## ๐ ุงููู ุจูุญุตู ุฌูู ุงูููุฏ (Under the hood)

1. ุงููุญุฑู ุจูุจุฏุฃ ูุณุฃู ุงูู `query_engine` ุงูุฃุณุงุณู ุนุดุงู ูุฌูุจ **ุงูุฑุฏ ุงูุฃูู**.  
2. ุจุนุฏูู ุจูุณุชุฎุฏู ุงูู `evaluator` ุนุดุงู ูููู ุงูุฑุฏ.  
3. ูู ุงูุฑุฏ **ุนุฏูู ุงูุชูููู** โ ุจูุฑุฌูุนู ุนูู ุทูู โ  
4. ูู ุงูุฑุฏ **ูุง ุนุฏูุงุด ุงูุชูููู** โ ุจูุจุฏุฃ ุณูุณูุฉ ุฎุทูุงุช ุฐููุฉ:

   - ุจููููู ูู **source node** (ุงููุตุฏุฑ ุงููู ุทูุน ููู ุงูุฑุฏ) ููุญุฏู.  
   - ุจูุฎุชุงุฑ ุจุณ ุงููุตุงุฏุฑ ุงููู ูุฌุญุช ูู ุงูุชูููู.  
   - ุจูุจูู **index ุฌุฏูุฏ** ุจุงููุตุงุฏุฑ ุงููู ูููุณุฉ ุฏู.  
   - ุจููููู **RetrieverQueryEngine ุฌุฏูุฏ** ูุจูู ุนูู ุงูู index ุงูุฌุฏูุฏ.  
   - ุจุนุฏ ูุฏู ุจูุนูู **RetrySourceQueryEngine ุฌุฏูุฏ** ุจุงูู `max_retries` ูุงูุต ูุงุญุฏ.  
   - ูุฃุฎูุฑูุงุ ุจูุนูุฏ ุชุดุบูู ุงูุงุณุชุนูุงู ุจุงููุณุฎุฉ ุงูุฌุฏูุฏุฉ ูู ุงููุญุฑู ๐  

5. ุจููุฑุฑ ุงูุฎุทูุงุช ุฏู ูุญุฏ ูุง ูุทูุน ุฑุฏ ูุฑุถู ุฃู ููุตู ูุฃูุตู ุนุฏุฏ ูุญุงููุงุช (`max_retries`).  

---

## โ ุงูุฎูุงุตุฉ

ุงูู **RetrySourceQueryEngine** ุฐูู ุฌุฏูุง ูู ุงูุชุนุงูู ูุน ูุตุงุฏุฑ ุงูุจูุงูุงุช ๐ก  
ูู ูุฑุฉ ุจูุญุณ ุฅู ุงูุฅุฌุงุจุฉ ูุด ุชูุงูุ ุจูุดูู ุฃููู ูุตุฏุฑ ุงูุณุจุจุ ููุดููู ูู ุงููุนุจุฉุ  
ููููู ุจุงููุตุงุฏุฑ ุงููููุฏุฉ ุจุณ โ ุนุดุงู ูุฏู ุจููุฏุฑ ูุทูุน ุฑุฏูุฏ ุฃุฏู ูุฌูุฏุชูุง ุฃุนูู ๐ช  
---
# โ๏ธ ุงููุฑู ุจูู ุฃููุงุน ุงูู Query Engines ูู LlamaIndex

ูู LlamaIndex ููู 3 ุฃููุงุน ูู ูุญุฑูุงุช ุงูุงุณุชุนูุงู (Query Engines)  
ูู ูุงุญุฏ ูููู ููู ุทุฑููุฉ ูุฎุชููุฉ ูุชุญุณูู ุฌูุฏุฉ ุงูุฑุฏูุฏ ๐  

---

### 1. ๐ **RetryQueryEngine**
- **ุงููุฏู:**  
  ุจูุญุณูู ุฌูุฏุฉ ุงูุฑุฏ ุนู ุทุฑูู ุฅุนุงุฏุฉ ุชุดุบูู ุงูุงุณุชุนูุงู ูู ุงูุฑุฏ ุงูุฃูู ูุง ุนุฏุงุด ุงูุชูููู.  

- **ุงูุทุฑููุฉ:**  
  ุจููููู ุงูุฑุฏ ุจูุงุกู ุนูู ูุนุงููุฑ ูุนููุฉุ  
  ููู ุงูุฑุฏ ูุด ููุงุณุจุ ุจูุนุฏูู ุงูุณุคุงู ููุญุงูู ุชุงูู ูุญุฏ ูุง ูุฌูุจ ูุชูุฌุฉ ูุฑุถูุฉ.

---

### 2. ๐ **RetrySourceQueryEngine**
- **ุงููุฏู:**  
  ุจูุทููุฑ ุฌูุฏุฉ ุงูุฅุฌุงุจุงุช ุนู ุทุฑูู ุฅุนุงุฏุฉ ุงูุงุณุชุนูุงู ุจุงุณุชุฎุฏุงู **ูุฌููุนุฉ ูู ุงููุตุงุฏุฑ ุงูููููุงุฉ**.  

- **ุงูุทุฑููุฉ:**  
  ุจููููู ูู ูุตุฏุฑ (source node) ููุญุฏูุ  
  ููุดูู ุงููู ูุด ูุงูุนุ  
  ูุจุนุฏูู ูุนูุฏ ุงูุงุณุชุนูุงู ุจุงุณุชุฎุฏุงู ุงููุตุงุฏุฑ ุงููู ุนุฏุง ุงูุชูููู ุจุณ.

---

### 3. ๐ง **RetryGuidelineQueryEngine**
- **ุงููุฏู:**  
  ุจูุฑููุฒ ุนูู ุชุญุณูู ุงูุฑุฏูุฏ ุจูุงุกู ุนูู **ููุงุนุฏ (Guidelines)** ูุญุฏุฏุฉ ูุณุจููุง.  

- **ุงูุทุฑููุฉ:**  
  ุจููููู ุงูุฑุฏ ุญุณุจ ุงูููุงุนุฏ ุฏูุ  
  ููู ุงูุฑุฏ ูุด ูุทุงุจูุ ุจูุญููู ุงูุณุคุงู ุจูุงุกู ุนูู ุงูู feedbackุ  
  ููุนูุฏ ุงููุญุงููุฉ ูุญุฏ ูุง ูุทูุน ุจุฑุฏ ูุถุจูุท ุนูู ุงููุนุงููุฑ.

---

## โ ุงูุฎูุงุตุฉ

ูู ููุน ูู ุงูู Query Engines ููู ุทุฑููุชู ุงูุฎุงุตุฉ ูู **ุชุตุญูุญ ูุชุญุณูู ุฌูุฏุฉ ุงูุฑุฏูุฏ**:  
- ุงูุฃูู ุจูุฑููุฒ ุนูู **ุงูุฑุฏ ููุณู**ุ  
- ุงูุชุงูู ุจูุฑููุฒ ุนูู **ุฌูุฏุฉ ุงููุตุงุฏุฑ**ุ  
- ูุงูุชุงูุช ุจูุฑููุฒ ุนูู **ุงูุงูุชุฒุงู ุจุงูููุงุนุฏ ูุงููุนุงููุฑ**.  

ูุนูู ุจุงุฎุชุตุงุฑุ ูู ูุงุญุฏ ูููู ุจูุนุงูุฌ ุฌุงูุจ ูุฎุชูู ูู ูุดููุฉ ุฌูุฏุฉ ุงูุฅุฌุงุจุงุช ๐ช  
